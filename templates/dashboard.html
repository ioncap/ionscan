<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>IonScan Report</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
:root{
    --bg: #0f172a; --card: #1e293b; --border: #334155; --text: #f1f5f9;
    --accent: #38bdf8; --purple: #a855f7;
    --risk-critical: #ef4444; --risk-high: #f97316; --risk-medium: #eab308;
    --risk-low: #22c55e; --risk-none: #38bdf8;
}
body{background:var(--bg);color:var(--text);font-family:'Inter',sans-serif;margin:0;padding:20px}
.container{max-width:1200px;margin:0 auto}
.stat-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin-bottom:20px}
.card{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:20px;overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:0.9rem}
th, td{padding:12px 15px;border-bottom:1px solid var(--border)}
th{text-align:left;color:#94a3b8;font-weight:600}
tbody tr:hover{background-color:#2c3a4f}
.badge{padding:4px 10px;border-radius:12px;font-size:0.75rem;font-weight:700;text-transform:uppercase}
.risk-critical{color:#fff;background:var(--risk-critical)}
.risk-high{color:#fff;background:var(--risk-high)}
.risk-medium{color:#1e293b;background:var(--risk-medium)}
.risk-low{color:#1e293b;background:var(--risk-low)}
.risk-none{color:#1e293b;background:var(--risk-none)}
.filter-toolbar{display:flex;gap:10px;margin-bottom:20px;align-items:center}
.filter-toolbar input{background:var(--bg);border:1px solid var(--border);color:var(--text);padding:8px;border-radius:6px;font-family:'Inter'}
.filter-toolbar .badge{cursor:pointer}
.expanded{background:#263344;border-left:3px solid var(--accent)}.details-row{display:none;background:#0f172a}
a{color:var(--accent);text-decoration:none}
</style></head><body><div class="container"><header><h1>IONSCAN Enterprise</h1><p>Generated: __DATE__</p></header>
<div class="stat-grid">
    <div class="card">
        <h2 style="font-size:1.2rem;margin-top:0">Risk Distribution</h2>
        <canvas id="risk-distribution"></canvas>
    </div>
    <div class="card">
        <h2 style="font-size:1.2rem;margin-top:0">Top 5 Vulnerabilities</h2>
        <canvas id="top-vulnerabilities"></canvas>
    </div>
</div>
<!-- REPORT_CONTENT -->
<script>
class Dashboard {
    constructor(chartData) {
        this.chartData = chartData;
        this.assetRows = document.querySelectorAll('#asset-table tbody tr.asset-row');
        this.init();
    }

    init() {
        this.createRiskDistributionChart();
        this.createTopVulnerabilitiesChart();
        this.setupFilters();
    }

    createRiskDistributionChart() {
        const riskCtx = document.getElementById('risk-distribution').getContext('2d');
        this.riskChart = new Chart(riskCtx, {
            type: 'doughnut',
            data: {
                labels: this.chartData.risk_distribution.map(d => d.label),
                datasets: [{
                    data: this.chartData.risk_distribution.map(d => d.count),
                    backgroundColor: this.chartData.risk_distribution.map(d => d.color),
                    borderColor: 'var(--card)',
                    borderWidth: 4
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { position: 'right', labels: { color: 'var(--text)' } }
                },
                onClick: (evt, elements) => {
                    if (elements.length > 0) {
                        const clickedIndex = elements[0].index;
                        const riskLevel = this.riskChart.data.labels[clickedIndex];
                        this.filterByRisk(riskLevel);
                    }
                }
            }
        });
    }

    createTopVulnerabilitiesChart() {
        const vulnCtx = document.getElementById('top-vulnerabilities').getContext('2d');
        new Chart(vulnCtx, {
            type: 'bar',
            data: {
                labels: Object.keys(this.chartData.top_vulnerabilities),
                datasets: [{
                    label: 'Count',
                    data: Object.values(this.chartData.top_vulnerabilities),
                    backgroundColor: '#a855f7',
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                plugins: { legend: { display: false } },
                scales: {
                    x: { ticks: { color: 'var(--text)' }, grid: { color: 'var(--border)' } },
                    y: { ticks: { color: 'var(--text)' }, grid: { color: 'var(--border)' } }
                }
            }
        });
    }

    setupFilters() {
        const searchInput = document.getElementById('search-input');
        searchInput.addEventListener('keyup', () => this.filterAssets());

        const riskFilters = document.querySelectorAll('.risk-filter');
        riskFilters.forEach(filter => {
            filter.addEventListener('click', () => {
                const riskLevel = filter.dataset.risk;
                this.filterByRisk(riskLevel);
            });
        });
    }
    
    filterByRisk(riskLevel) {
        document.querySelectorAll('.risk-filter').forEach(b => b.style.opacity = '0.5');
        const activeFilter = document.querySelector(`.risk-filter[data-risk="${riskLevel}"]`);
        if (activeFilter) activeFilter.style.opacity = '1';
        
        this.assetRows.forEach(row => {
            const rowRisk = row.dataset.risk;
            if (riskLevel === 'All' || rowRisk === riskLevel) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    }

    filterAssets() {
        const searchTerm = document.getElementById('search-input').value.toLowerCase();
        this.assetRows.forEach(row => {
            const assetIp = row.querySelector('strong').textContent.toLowerCase();
            const vendor = row.querySelector('div').textContent.toLowerCase();
            if (assetIp.includes(searchTerm) || vendor.includes(searchTerm)) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    }
}

function toggle(id,el){var r=document.getElementById('row-'+id);if(r.style.display==='table-row'){r.style.display='none';el.classList.remove('expanded')}else{r.style.display='table-row';el.classList.add('expanded')}}

document.addEventListener('DOMContentLoaded', () => {
    const chartData = __CHART_DATA__;
    new Dashboard(chartData);
});
</script></body></html>
